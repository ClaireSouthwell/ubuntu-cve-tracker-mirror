Candidate: CVE-2017-9047
PublicDate: 2017-05-18
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9047
 http://www.openwall.com/lists/oss-security/2017/05/15/1
Description:
 A buffer overflow was discovered in libxml2 20904-GITv2.9.4-16-g0741801.
 The function xmlSnprintfElementContent in valid.c is supposed to
 recursively dump the element content definition into a char buffer 'buf' of
 size 'size'. The variable len is assigned strlen(buf). If the content->type
 is XML_ELEMENT_CONTENT_ELEMENT, then (i) the content->prefix is appended to
 buf (if it actually fits) whereupon (ii) content->name is written to the
 buffer. However, the check for whether the content->name actually fits also
 uses 'len' rather than the updated buffer length strlen(buf). This allows
 us to write about "size" many bytes beyond the allocated memory. This
 vulnerability causes programs that use libxml2, such as PHP, to crash.
Ubuntu-Description:
Notes:
Bugs:
 https://bugzilla.gnome.org/show_bug.cgi?id=781333
 https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=863022
Priority: medium
Discovered-by: Marcel BÃ¶hme and Van-Thuan Pham
Assigned-to:

Patches_libxml2:
 upstream: https://git.gnome.org/browse/libxml2/commit/?id=932cc9896ab41475d4aa429c27d9afd175959d74
upstream_libxml2: released (2.9.4+dfsg1-3.1)
precise/esm_libxml2: needed
trusty_libxml2: needed
vivid/stable-phone-overlay_libxml2: ignored (reached end-of-life)
vivid/ubuntu-core_libxml2: DNE
xenial_libxml2: needed
yakkety_libxml2: ignored (reached end-of-life)
zesty_libxml2: needed
devel_libxml2: not-affected (2.9.4+dfsg1-3.1)
