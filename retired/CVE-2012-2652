PublicDateAtUSN: 2012-06-18
Candidate: CVE-2012-2652
PublicDate: 2012-06-18
References:
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2652
 http://www.ubuntu.com/usn/usn-1522-1
Description:
 A flaw was found in how qemu, in snapshot mode (-snapshot command line
 argument), handled the creation and opening of the temporary file used to
 store the difference of the virtualized guest's read-only image and the
 current state.  In snapshot mode, bdrv_open() creates an empty temporary file
 without checking for any mkstemp() or close() failures; it also ignores the
 possibility of a buffer overrun given an exceptionally long $TMPDIR.  Because
 qemu re-opens that file after creation, it is possible to race qemu and insert
 a symbolic link with the same expected name as the temporary file, pointing to
 an attacker-chosen file.  This can be used to either overwrite the destination
 file with the privileges of the user running qemu (typically root), or to
 point to an attacker-readable file that could expose data from the guest to
 the attacker.
Ubuntu-Description:
Notes:
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=824919
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=678280
Priority: medium
Discovered-by:
Assigned-to: mdeslaur

Tags_qemu-kvm: symlink-restriction
Priority_natty_qemu-kvm: low
Priority_oneiric_qemu-kvm: low
Priority_precise_qemu-kvm: low
Priority_devel_qemu-kvm: low
Patches_qemu-kvm:
 patch: http://marc.info/?l=qemu-devel&m=133819025731504&w=2
 upstream: http://git.kernel.org/?p=virt/kvm/qemu-kvm.git;a=commit;h=eba25057b9a5e19d10ace2bc7716667a31297169
upstream_qemu-kvm: needs-triage
hardy_qemu-kvm: DNE
lucid_qemu-kvm: released (0.12.3+noroms-0ubuntu9.19)
natty_qemu-kvm: released (0.14.0+noroms-0ubuntu4.6)
oneiric_qemu-kvm: released (0.14.1+noroms-0ubuntu6.4)
precise_qemu-kvm: released (1.0+noroms-0ubuntu14.1)
devel_qemu-kvm: not-affected (1.1~rc+dfsg-1ubuntu9)

Patches_qemu:
upstream_qemu: needs-triage
hardy_qemu: ignored (reached end-of-life)
lucid_qemu: DNE
natty_qemu: DNE
oneiric_qemu: DNE
precise_qemu: DNE
devel_qemu: DNE

Patches_kvm:
upstream_kvm: needs-triage
hardy_kvm: ignored (reached end-of-life)
lucid_kvm: DNE
natty_kvm: DNE
oneiric_kvm: DNE
precise_kvm: DNE
devel_kvm: DNE
