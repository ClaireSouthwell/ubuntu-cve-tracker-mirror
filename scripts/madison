#!/usr/bin/python
# Really simple madison-like reporting tool that uses source_map data for
# reporting.  Note that it only reports the highest version's entry for
# a given source pkg's release.
#
# Copyright 2008, Canonical Ltd.
# Author: Kees Cook <kees@ubuntu.com>
# Author: Jamie Strandboge <jamie@ubuntu.com>
import sys
import cve_lib

import source_map
source = source_map.load()

pkg = sys.argv[1]

for rel in cve_lib.releases:
    if rel in cve_lib.eol_releases:
        continue
    if source[rel].has_key(pkg):
        name = rel
        if source[rel][pkg]['pocket'] != '':
            name += '-%s' % (source[rel][pkg]['pocket'])
        name += '/%s' % (source[rel][pkg]['section'])
        print '%s | %s | %s' % (pkg, source[rel][pkg]['version'], name)
