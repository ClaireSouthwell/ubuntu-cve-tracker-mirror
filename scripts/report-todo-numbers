#!/bin/bash
# Reports a terse numeric of CVEs that need attention for supported packages.
OUT=""
for prio in critical high medium low very-low
do
    COUNT=$(../scripts/ubuntu-table -s | grep SUP | grep ' '"$prio"'$' | wc -l)
    if [ "$COUNT" -gt 0 ]; then
        if [ -n "$OUT" ]; then
            OUT="$OUT, "
        fi
        OUT="$OUT$COUNT $prio"
    fi
done
if [ -z "$OUT" ]; then
    OUT="none!  :)"
else
    COUNT=$(../scripts/ubuntu-table -s | grep SUP | cut -d" " -f2 | cut -d: -f1 | sort -u | wc -l)
    OUT="$OUT, in $COUNT supported package"
    if [ "$COUNT" -ne 1 ]; then
        OUT="${OUT}s"
    fi
fi
echo "CVEs pending: $OUT"
