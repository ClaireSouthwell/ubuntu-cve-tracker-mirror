#!/bin/sh
# Copyright (C) 2011, 2016 Canonical, Ltd.
# Author: Marc Deslauriers <marc.deslauriers@canonical.com>
# Author: Steve Beattie <steve.beattie@canonical.com>
# License: GPLv3

set -e

help() {
    cat <<EOM
Usage: add-backport-kernel -l <lts> -b <backport>

  -l    lts release (ex: lucid) (REQUIRED)
  -b    backport release (ex: oneiric) (REQUIRED)
EOM
}

LTS=
BACKPORT=

while getopts "hl:b:" opt
do
    case "$opt" in
        l) LTS="$OPTARG";;
        b) BACKPORT="$OPTARG";;
        h) help ; exit 0;;
        ?) help;;
    esac
done

if [ -z "$LTS" ] || [ -z "$BACKPORT" ]; then
    help
    exit 1
fi

./scripts/add-derived-kernel -r "${LTS}" -d "${BACKPORT}" "lts-${BACKPORT}"
