PublicDateAtUSN: 2020-07-15 12:00:00
Candidate: CVE-2020-11934
CRD: 2020-07-15 12:00:00 
PublicDate: 2020-07-15 12:00:00
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11934
 https://usn.ubuntu.com/usn/usn-4424-1
Description:
 A sandbox escape vulnerability was found in the snapctl user-open
 (xdg-open) implementation. By adding a directory controlled by the snap
 to $XDG_DATA_DIRS, it allows the snap to control how the host system
 xdg-open script opens the URL.
Ubuntu-Description:
 It was discovered that snapctl user-open allowed altering the $XDG_DATA_DIRS
 environment variable when calling the system xdg-open. A malicious snap 
 could exploit this to bypass intended access restrictions to control how 
 the host system xdg-open script opens the URL. This issue did not affect
 Ubuntu Core systems. (CVE-2020-11934)
Notes:
 emitorino> Since the vulnerability is present on the userd's OpenURL
  implementation, it only affects classic distros where userd is 
  auto-started.
 emitorino> Since userd cannot be auto-started on Ubuntu Core 16, Ubuntu 
  Core 18 or Ubuntu Core 20 (for various reasons depending on the 
  release), then Ubuntu Core is not affected.
 emitorino> Even if userd happened to start (eg, the user started it 
  manually on UC20) there is no implicitOnCore policy that allows 
  communicating with io.snapcraft.Launcher (or the older 
  com.canonical.SafeLauncher).
 emitorino> The dbus interface can't be used (with either plugs or slots)
  to communicate with userd.
 emitorino> /usr/bin/xdg-open on the boot file system of an Ubuntu Core 
  system is different to Classic: it is the sandbox proxy that calls back
  into userd. Even if a session bus is running and a confined app could 
  call userd, userd will report an error because the caller is not confined
Mitigation:
Bugs:
 https://bugs.launchpad.net/snapd/+bug/1880085
Priority: medium
Discovered-by: James Henstridge
Assigned-to: emitorino
CVSS:
 ubuntu: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H


Patches_snapd:
 upstream: https://github.com/snapcore/snapd/commit/06342a31878f1cf99d56da5483e71b9af61f46ad
upstream_snapd: released (2.45.2)
precise/esm_snapd: DNE
trusty_snapd: ignored (out of standard support)
trusty/esm_snapd: DNE
xenial_snapd: released (2.45.1ubuntu0.2)
bionic_snapd: released (2.45.1+18.04.2)
eoan_snapd: released (2.45.1+19.10.2)
focal_snapd: released (2.45.1+20.04.2)
devel_snapd: needed
