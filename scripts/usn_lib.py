#!/usr/bin/python

# Author: Kees Cook <kees@ubuntu.com>
# Author: Jamie Strandboge <jamie@ubuntu.com>
# Copyright (C) 2005-2008 Canonical Ltd.
#
# This script is distributed under the terms and conditions of the GNU General
# Public License, Version 2 or later. See http://www.gnu.org/copyleft/gpl.html
# for details.

import os, cPickle

def load_database(db_filename='database.pickle'):
    '''Load usn database'''
    filename = os.path.expanduser(db_filename)
    if not os.path.isfile(db_filename):
        return {}
    file = open(db_filename)
    database = cPickle.load(file)
    file.close()
    return database

def get_reverted(filename='reverted-CVEs.txt'):
    '''Get reverted USNs'''
    reverted = dict()
    if os.path.exists(filename):
        for line in open(filename):
            elements = line.rstrip().split(' ')
            usn = elements.pop(0)
            reverted.setdefault(usn,set())
            for cve in elements:
                reverted[usn].add(cve)

    return reverted
