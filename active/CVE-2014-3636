Candidate: CVE-2014-3636
PublicDate: 2014-09-17
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3636
 http://www.openwall.com/lists/oss-security/2014/09/16/9
Description: 
 The default limits for the system bus allowed each uid to open 256
 connections to the system bus, and allowed up to 1024 fds per message,
 and up to 4096 fds queued in total on each connection.
 (Part A) By queuing up the maximum allowed number of fds, a malicious
 sender could reach the dbus-daemon's RLIMIT_NOFILE (ulimit -n, typically
 65536 on Linux). This would act as a denial of service in two ways.
 (Part B) Additionally, Linux allows up to 253 fds to be sent in a single
 sendmsg() call; libdbus always sends all of a message's fds, and the
 beginning of the message itself, in a single sendmsg() call. Combining
 these two, a malicious sender could split a message across two or more
 sendmsg() calls to construct a composite message with 254 or more fds.
 When dbus-daemon attempted to relay that message to its
 recipient in a single sendmsg() call, it would receive EINVAL,
 interpret that as a fatal socket error and disconnect the recipient,
 resulting in denial of service.
Ubuntu-Description: 
Notes: 
 mdeslaur> commit in 1.6 seems to have wrong header
Bugs: 
 https://bugs.freedesktop.org/show_bug.cgi?id=82820
Priority: medium
Discovered-by: Alban Crequy
Assigned-to: mdeslaur

Patches_dbus:
 upstream: http://cgit.freedesktop.org/dbus/dbus/commit/?id=6465e37c8ff70a714e302d0c9e6534fa6181fce6 (1.8)
 upstream: http://cgit.freedesktop.org/dbus/dbus/commit/?h=dbus-1.6&id=346da99f7620e6901e7c7babd4590fcc5aac32bf (1.6)
upstream_dbus: released (1.6.24,1.8.8)
lucid_dbus: needed
precise_dbus: needed
trusty_dbus: needed
devel_dbus: needed
