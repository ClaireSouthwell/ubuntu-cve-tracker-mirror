Candidate: CVE-2013-1922
CRD: 2013-04-15 15:00:00 UTC
PublicDate: 2013-04-15 15:00:00 UTC
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1922
 http://www.openwall.com/lists/oss-security/2013/04/15/3
Description: 
 A security flaw was found in the way qemu-nbd, the QEMU Disk Network
 Block Device server tool of QEMU, performed detection of image formats
 (the image format has been previously autodetected). A guest operating
 system administrator could write a header to particular raw disk image
 format, describing another format than original one for that disk image,
 leading to scenario in which after restart of that guest, QEMU would
 detect new format of the image, and could allow the guest to read any
 file on the host if QEMU was sufficiently privileged.
Ubuntu-Description: 
Notes:
 jdstrand> patch removes autodetection and forces the use of new --format
  argument. Will need to see what uses qemu-nbd and verify it works ok.
 jdstrand> attack is: privileged attacker in the guest that uses a raw image
  writes data to beginning of device. Later, someone on the host uses qemu-nbd
  on the attacker-modified image. When the guest is rebooted, the attacker may
  have access to other files.
 jdstrand> On Ubuntu, the preferred virtualization management technology is
  libvirt. As of USN-1008-1, libvirt does not probe the disk format, which
  reduces this attack to a denial of server for the guest (ie, the
  attacker-modified image is not usable on reboot).
 jdstrand> TODO: review use in nova
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=923219
Priority: medium
Discovered-by: Daniel Berrange
Assigned-to: 

Patches_qemu-kvm:
 patch: https://bugzilla.redhat.com/attachment.cgi?id=712650&action=diff
upstream_qemu-kvm: needs-triage
hardy_qemu-kvm: DNE
lucid_qemu-kvm: needed
oneiric_qemu-kvm: needed
precise_qemu-kvm: needed
quantal_qemu-kvm: needed
devel_qemu-kvm: DNE

Patches_qemu:
upstream_qemu: needed
hardy_qemu: ignored (reached end-of-life)
lucid_qemu: DNE
oneiric_qemu: DNE
precise_qemu: DNE
quantal_qemu: DNE
devel_qemu: needed

