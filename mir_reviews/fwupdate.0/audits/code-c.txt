Running: /home/sarnold/bin/audit-code.sh -c C ./
Scanning './'
== subprocess_spawned() ==

== memory_management() ==
./linux/util.h:42:	if (!(newbuf = calloc(size, sizeof (uint8_t))))
./linux/util.h:102:		memcpy(__newbuf, buf, len);				\
./linux/libfwup.c:52:		sprintf(unknown, "Unknown error %d\n", error);
./linux/libfwup.c:93:	strcpy(buf, dgettext("libfwup", error_table[error - ERANGE]));
./linux/libfwup.c:106:			strcpy(_ret, _alt_dir?_alt_dir:_esrt_dir);	\
./linux/libfwup.c:176:	rc = asprintf(&varname, "fwupdate-%s-%"PRIx64, guidstr, hw_inst);
./linux/libfwup.c:189:		local = calloc(1, sizeof (*local));
./linux/libfwup.c:199:		local->dp_ptr = calloc(1, 1024);
./linux/libfwup.c:228:	efidp_header *dp = malloc(efidp_size((efidp)local->dp));
./linux/libfwup.c:232:	memcpy(dp, local->dp, efidp_size((efidp)local->dp));
./linux/libfwup.c:259:	rc = asprintf(&varname, "fwupdate-%s-%"PRIx64, guidstr, info->hw_inst);
./linux/libfwup.c:273:	memcpy(info2, info, sizeof(*info));
./linux/libfwup.c:274:	memcpy(info2->dp, info->dp_ptr, dps);
./linux/libfwup.c:304:	fwup_resource_iter *new = calloc(1, sizeof (fwup_resource_iter));
./linux/libfwup.c:567:	dp_buf = calloc(1, dp_size);
./linux/libfwup.c:598:	opt = calloc(1, sz);
./linux/libfwup.c:696:		sprintf(boot_next_name, "Boot%04X", boot_next);
./linux/libfwup.c:776:		rc = asprintf(&fullpath, "/boot/efi/%s", relpath);
./linux/libfwup.c:791:		rc = asprintf(&fullpath,
./linux/libfwup.c:861:		dp_buf = calloc(1, req);
./linux/ucs2.h:74:	uint16_t *ret = calloc(utf8len(utf8, max) + 1, sizeof (uint16_t));

== files() ==
./linux/fwupdate.c:232:				int fd = open(filename, O_RDONLY);
./linux/libfwup.c:782:		rc = open(fullpath, O_CREAT|O_TRUNC|O_CLOEXEC|O_RDWR);

== logging() ==
./linux/fwupdate.c:84:			fwup_warn("Could not create iterator");
./linux/fwupdate.c:157:			poptBadOption(optcon, 0), poptStrerror(rc));
./linux/fwupdate.c:186:			poptBadOption(optcon, 0), poptStrerror(rc));
./linux/fwupdate.c:239:					errx(2, _("Could not set up firmware update: %s"), fwup_strerror(fwup_error));
./linux/libfwup.c:49:fwup_strerror(int error)
./linux/libfwup.c:56:		return strerror(error);
./linux/libfwup.c:743:		warn("get_info failed.\n");
./linux/libfwup.c:795:			warn("asprintf failed");
./linux/libfwup.c:802:			warn("mkostemps(%s) failed", fullpath);
./linux/libfwup.c:826:					warn("write failed");
./linux/libfwup.c:837:			warn("read failed");
./linux/libfwup.c:881:		warn("put_info failed.\n");
./linux/include/fwup.h:19:#define fwup_error (*__fwup_error_location())
./linux/include/fwup.h:20:extern const char const *fwup_strerror(int error);
./linux/include/fwup.h:22:#define fwup_warn(fmt, args...) \
./linux/include/fwup.h:23:	warnx(fmt ": %s", ## args, fwup_strerror(fwup_error));
./linux/include/fwup.h:25:	errx(val, fmt ": %s", ## args, fwup_strerror(fwup_error));

== environment() ==
./linux/libfwup.c:101:		char *_alt_dir = getenv("LIBFWUP_ESRT_DIR");		\
./linux/tester.c:9:	setenv("LIBFWUP_ESRT_DIR", "sys/firmware/efi/esrt/", 1);

== privileged() ==

== networking() ==
./linux/util.h:51:		s = read(fd, p, size - filesize);
./linux/libfwup.c:815:		sz = read(infd, &buf, 4096);
./linux/libfwup.c:820:				wsz = write(fd, buf+off, sz-off);

== http:// ==

== encryption ==

== sql() ==

== tmp() ==

== priv_cmds (sudo, gksu, pkexec) ==

== envvars() ==

== webkit() ==

== comments (XXX, FIXME, TODO) ==
./linux/libfwup.c:530:/* XXX PJFIX: this should be in efiboot-loadopt.h in efivar */
./linux/libfwup.c:792:			      "/boot/efi/EFI/%s/fw/fwupdate-XXXXXX.cap",

== unsafe input mechanisms ==

