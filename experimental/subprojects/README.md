# Security Subprojects

## Purpose
The security team needs to track CVEs differently for different purpose. For
example, fixes for some CVEs against Universe packages are only added to the ESM
PPA. 

## Summary
The security team can create a subproject by creating a subdirectory under
experimental/subprojects/ and placing a project.conf file within the new
subdirectory. CVE files (like those in $UCT/active) can be added to the
project's subdirectory. These CVE files follow the same format as in $UCT but
contain information that can be appended to or replace the data in the matching
CVE file in $UCT. $UCT/scripts/cve_lib.py has been updated to allow code to
specify which subprojects cve_lib should consult when loading CVE data.

## Configuration
Each subproject has a configuration file at
experimental/subprojects/SUBPROJECT_DIRECTORY/project.conf the project.conf
file currentl supports the following options

* notes - Specify what to do with notes found in the subproject's CVE files.
          Options are:
    - append: Append the subproject's notes to the CVE's notes in $UCT.
    - replace: Replace the CVE's notes from $UCT with the subproject's notes.
* assigned_to (optional) - Specify what to do with the "Assigned_to" field if it
                           is found in the subproject's CVE files. options are:
    - replace: Replace the CVE's "Assigned_to" field from $UCT with the
               subproject's.
* pkg - Specify what to do with package/release status found in the subproject's
        CVE files. Options are:
    - append: Append a new release named "RELEASE/project_name" with the status
              as specified in the subproject's CVE file
    - replace: Replace the status of the release with the status for that
               release specified in the subproject's CVE file
* pkg_default - Specify what to do if a pkg does not exist in the subproject's
                CVE file. Options are:
    - copy_release: Copy the status from the $UCT CVE file for each release
    - skip: Do not add the subproject's release to the CVE data
* release_list - Specify which Ubuntu releases this project is applicable to
    - This option takes a comma separated set of strings
    - Example: release_list="trusty","xenial","bionic"
* project_name - The name of this project. This name will be appended to the
                 release when packages are appended to CVE data

### Example Configuration
```
notes="append"
assigned_to="replace"
pkg="append"
pkg_default="copy_release"
release_list="trusty","xenial","bionic"
project_name="esm"
```

### Example CVE

This example uses the Example Configuration as shown above.

Given the following CVE file from $UCT
```
Candidate: CVE-2018-9273
PublicDate: 2018-04-04
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9273
 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=14488
 https://code.wireshark.org/review/gitweb?p=wireshark.git;a=commit;h=1f8f1456f1e73b6c09e50a64749e43413ac12df7
 https://www.wireshark.org/security/wnpa-sec-2018-24.html
Description:
 In Wireshark 2.4.0 to 2.4.5 and 2.2.0 to 2.2.13,
 epan/dissectors/packet-pcp.c has a memory leak.
Ubuntu-Description:
Notes:
 anon> A note
Bugs:
Priority: untriaged
Discovered-by:
Assigned-to:


Patches_wireshark:
upstream_wireshark: needs-triage
precise/esm_wireshark: DNE
trusty_wireshark: released (2.6.3)
xenial_wireshark: released (2.6.3)
artful_wireshark: ignored (reached end-of-life)
bionic_wireshark: released (2.6.3)
devel_wireshark: not-affected (2.6.3-1)
```
And the following CVE file from the esm-universe subproject
```
Notes:
 anon2> An extra note
trusty_wireshark: released-esm (2.6.3+esm1)
bionic_wireshark: released-esm (2.6.3)
```

Run the below script to gather data for the CVE
```
#!/usr/bin/env python

import cve_lib
import pprint

cve_lib.read_config()
data = cve_lib.load_cve("active/CVE-2018-9273", subprojects=["esm-universe"])
pprint.pprint(data)
```

The above script will produce the output:
```
{u'Assigned-to': u'',
 u'Bugs': u'',
 u'Candidate': u'CVE-2018-9273',
 u'Description': u'\nIn Wireshark 2.4.0 to 2.4.5 and 2.2.0 to 2.2.13,\nepan/dissectors/packet-pcp.c has a memory leak.',
 u'Discovered-by': u'',
 u'Notes': u'\nanon> A note\nanon2> An extra note',
 u'Patches_wireshark': u'',
 u'Priority': u'untriaged',
 u'PublicDate': u'2018-04-04',
 u'References': u'\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9273\nhttps://bugs.wireshark.org/bugzilla/show_bug.cgi?id=14488\nhttps://code.wireshark.org/review/gitweb?p=wireshark.git;a=commit;h=1f8f1456f1e73b6c09e50a64749e43413ac12df7\nhttps://www.wireshark.org/security/wnpa-sec-2018-24.html',
 u'Ubuntu-Description': u'',
 'pkgs': {u'wireshark': {u'artful': [u'ignored', u'reached end-of-life'],
                         u'bionic': [u'released', u'2.6.3'],
                         u'bionic/esm': [u'released-esm', u'2.6.3'],
                         u'devel': [u'not-affected', u'2.6.3-1'],
                         u'precise/esm': [u'DNE', ''],
                         u'trusty': [u'released', u'2.6.3'],
                         u'trusty/esm': [u'released-esm', u'2.6.3+esm1'],
                         u'upstream': [u'needs-triage', ''],
                         u'xenial': [u'released', u'2.6.3'],
                         u'xenial/esm': [u'released', u'2.6.3'],
 'tags': {}}
```




