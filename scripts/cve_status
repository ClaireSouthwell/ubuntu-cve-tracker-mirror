#!/bin/sh
set -e
#
# Usage:
# cd active/
# ../scripts/cve_status CVE-XXXX-XXXX CVE-XXXX-XXXX
#

just_status=
if [ "$1" = "-s" ]; then
	shift || true
	just_status="yes"
fi

for c in "$@"
do
	if [ -s "../retired/${c}" ]; then
		echo "$c (retired)"
	elif [ -s "../ignored/${c}" ]; then
		echo "$c (ignored)"
	elif fgrep -q "$c" ../ignored/not-for-us.txt ; then
		echo "$c (not for us)"
	elif [ -s "$c" ]; then
		../scripts/ubuntu-table --supported 2>/dev/null | egrep "($c|[[:space:]]+dapper)"
		if [ -z "$just_status" ]; then
			echo ""
			cat $c
			echo ""
		fi
	else
		echo "$c (not found)"
	fi
done

