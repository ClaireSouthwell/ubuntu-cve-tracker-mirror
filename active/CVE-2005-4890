Candidate: CVE-2005-4890
PublicDate: 2011-12-20
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4890
 http://www.openwall.com/lists/oss-security/2011/06/02/3
Description: 
 When starting a program via "su - user -c program" the user session can escape 
 to the parent session by using the TIOCSTI ioctl to push characters into the 
 input buffer.  This allows for example a non-root session to push 
 "chmod 666 /etc/shadow" or similarly bad commands into the input buffer such 
 that after the end of the session they are executed.
Ubuntu-Description: 
Notes: 
 mdeslaur> sudo is also apprently vulnerable to this, so the use_pty
 mdeslaur> option was added. We need to verify versions, and make sure
 mdeslaur> it is actually getting honored (apparently the option wasn't
 mdeslaur> working: http://www.openwall.com/lists/oss-security/2011/06/22/4)
 jdstrand> sudo in 12.04 and higher has the fix for use_pty. A small patch
  (http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1) can be used to enable it
  on Ubuntu 11.04 and 11.10.
Bugs: 
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843
 https://bugzilla.redhat.com/show_bug.cgi?id=710208
 https://bugzilla.redhat.com/show_bug.cgi?id=173008
 https://bugzilla.redhat.com/show_bug.cgi?id=199066
 https://bugzilla.redhat.com/show_bug.cgi?id=479145
Priority: low
Discovered-by:
Assigned-to: 

Patches_shadow:
upstream_shadow: needs-triage
hardy_shadow: needed
lucid_shadow: needed
maverick_shadow: ignored (reached end-of-life)
natty_shadow: ignored (reached end-of-life)
oneiric_shadow: needed
precise_shadow: needed
quantal_shadow: needed
devel_shadow: needed

Patches_sudo:
 upstream: http://www.sudo.ws/repos/sudo/rev/aea971f1456a (pt1)
 upstream: http://www.sudo.ws/repos/sudo/rev/e7b167f8a6e5 (pt2)
 upstream: http://www.sudo.ws/repos/sudo/rev/26120a59c20e (pt3)
 upstream: http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1 (pt4)
upstream_sudo: released (1.8.2)
hardy_sudo: needed
lucid_sudo: needed
maverick_sudo: ignored (reached end-of-life)
natty_sudo: ignored (reached end-of-life)
oneiric_sudo: needed
precise_sudo: not-affected (1.8.3p2-1ubuntu2)
quantal_sudo: not-affected
devel_sudo: not-affected
