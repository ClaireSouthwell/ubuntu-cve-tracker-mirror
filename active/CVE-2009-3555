Candidate: CVE-2009-3555
PublicDate: 2009-11-09
References: 
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555
 http://www.imc.org/ietf-tls/mail-archive/msg09837.html
 http://extendedsubset.com/
 http://extendedsubset.com/Renegotiating_TLS.pdf
 http://extendedsubset.com/Renegotiating_TLS_pd.pdf
 http://www.ietf.org/mail-archive/web/tls/current/msg03963.html
 http://www.links.org/?p=780
 http://www.links.org/?p=786
 http://mail-archives.apache.org/mod_mbox/httpd-announce/200911.mbox/%3C20091107013220.31376.qmail@minotaur.apache.org%3E
Description:
 The TLS protocol, and the SSL protocol 3.0 and possibly earlier, as used in
 Microsoft Internet Information Services (IIS) 7.0, mod_ssl in the Apache
 HTTP Server 2.2.14 and earlier, OpenSSL before 0.9.8l, GnuTLS 2.8.5 and
 earlier, Mozilla Network Security Services (NSS) 3.12.4 and earlier, and
 other products, does not properly associate renegotiation handshakes with
 an existing connection, which allows man-in-the-middle attackers to insert
 data into HTTPS sessions, and possibly other types of sessions protected by
 TLS or SSL, by sending an unauthenticated request that is processed
 retroactively by a server in a post-renegotiation context, related to a
 "plaintext injection" attack, aka the "Project Mogul" issue.
Ubuntu-Description: 
Notes: 
 jdstrand> Fixing this issue requires coordination between the IETF, SSL
  libraries (eg OpenSSL and GnuTLS) and TLS consumers (notably HTTPS servers,
  but most (or all) servers using TLS which support client-initiated
  renegotiation). Protocol-breaking changes are among the possibilities being
  discussed.

  The following is based on http://extendedsubset.com/Renegotiating_TLS.pdf
  and http://extendedsubset.com/Renegotiating_TLS_pd.pdf. You are encouraged to
  read this document as well as the email thread on ietf-tls for complete
  information and most up-to-date status (see References).

  There are essentially 3 types of renegotiation scenarios known at this time
  to be vulnerable, and they all require a man-in-the-middle (MITM) attack:
   1. Client certificate authentication: servers configured to require client
      certificate authentication on a per-directory basis. Apache is known
      to be vulnerable when using this configuration. There is no generally
      usable mitigation strategy known at this time.
   2. Differing server cryptographic requirements: servers configured to
      support different cipher suites within the same site. One mitigation
      strategy is to require all content on a site to use a single cipher
      suite. Disallowing specification of TLS parameters in .htaccess files
      (generally modifiable by end users) may also be a good idea.
   3. Client-initiated renegotiation: servers configured for TLS. Apache is
      known to be vulnerable when using using TLS and the client initiates a
      renegotiation. There is no generally usable mitigation strategy known at
      this time.

  The flaw should not allow the attacker to see the contents of the connection,
  and a client cannot be redirected to another site. For the HTTPS scenarios
  listed above, the attacker is able to perform arbitrary GET requests with
  the credentials of the victim. Arbitrary POST requests may also be possible.

  Analysis on the effects of this flaw for other protocols is ongoing.

  Until a general fix can be found for Ubuntu, users may be interested in
  reading http://www.links.org/?p=780, which has a patch to OpenSSL to disable
  all renegotiation.
 jdstrand> Working on update to disable client initiated renegotiations for
  Apache. This won't fix per-directory configurations.
Bugs: 
Priority: medium
Discovered-by: Marsh Ray, Steve Dispensa
Assigned-to: jdstrand

Patches_openssl:
upstream_openssl: needed
dapper_openssl: needed
hardy_openssl: needed
intrepid_openssl: needed
jaunty_openssl: needed
karmic_openssl: needed
devel_openssl: needed

Patches_apache2:
 vendor: http://www.mandriva.com/en/security/advisories?name=MDVSA-2009:295
upstream_apache2: released (2.2.14-2)
dapper_apache2: pending
hardy_apache2: pending
intrepid_apache2: pending
jaunty_apache2: pending
karmic_apache2: pending
devel_apache2: released (2.2.14-2ubuntu1)

Patches_gnutls12:
upstream_gnutls12: needed
dapper_gnutls12: needed
hardy_gnutls12: DNE
intrepid_gnutls12: DNE
jaunty_gnutls12: DNE
karmic_gnutls12: DNE
devel_gnutls12: DNE

Patches_gnutls13:
upstream_gnutls13: needed
dapper_gnutls13: DNE
hardy_gnutls13: needed
intrepid_gnutls13: DNE
jaunty_gnutls13: DNE
karmic_gnutls13: DNE
devel_gnutls13: DNE

Patches_gnutls26:
upstream_gnutls26: needed
dapper_gnutls26: DNE
hardy_gnutls26: DNE
intrepid_gnutls26: needed
jaunty_gnutls26: needed
karmic_gnutls26: needed
devel_gnutls26: needed

Patches_libapache-mod-ssl:
upstream_apache2: needs-triage
dapper_apache2: needs-triage
hardy_apache2: DNE
intrepid_apache2: DNE
jaunty_apache2: DNE
karmic_apache2: DNE
devel_apache2: DNE

