PublicDateAtUSN: 2011-11-25
Candidate: CVE-2011-4347
PublicDate: 2011-11-25
References:
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4347
 http://www.openwall.com/lists/oss-security/2011/11/24/6
 http://thread.gmane.org/gmane.comp.emulators.kvm.devel/82043
 http://www.ubuntu.com/usn/usn-1389-1
Description:
 It was found that kvm_vm_ioctl_assign_device function did not check if
 the user requesting assignment was privileged or not. Together with
 /dev/kvm being 666, unprivileged user could assign unused pci devices,
 or even devices that were in use and whose resources were not properly
 claimed by the respective drivers.

 Please note that privileged access was still needed to re-program the
 device to for example issue DMA requests. This is typically achieved by
 touching files on sysfs filesystem. These files are usually not
 accessible to unprivileged users.

 As a result, local user could use this flaw to crash the system.
Ubuntu-Description:
 Sasha Levin discovered a flaw in the permission checking for device
 assignments requested via the kvm ioctl in the Linux kernel. A local user
 could use this flaw to crash the system causing a denial of service.
Notes:
Bugs:
 https://bugzilla.redhat.com/show_bug.cgi?id=756084
 https://launchpad.net/bugs/897812
Priority: low
Discovered-by: Sasha Levin
Assigned-to: 

Patches_linux:
 break-fix: 4d5c5d0fe89c921336b95f5e7e4f529a9df92f53 3d27e23b17010c668db311140b17bbbb70c78fb9
 break-fix: 4d5c5d0fe89c921336b95f5e7e4f529a9df92f53 423873736b78f549fbfa2f715f2e4de7e6c5e1e9
upstream_linux: released (3.2)
hardy_linux: not-affected
lucid_linux: pending
maverick_linux: pending (2.6.35-32.68)
natty_linux: pending (2.6.38-14.58)
oneiric_linux: pending (3.0.0-18.31)
devel_linux: not-affected (3.2.0-8.14)

Patches_linux-ec2:
upstream_linux-ec2: released (3.2)
hardy_linux-ec2: DNE
lucid_linux-ec2: pending
maverick_linux-ec2: ignored (binary supplied by "linux" now)
natty_linux-ec2: DNE
oneiric_linux-ec2: DNE
devel_linux-ec2: DNE

Patches_linux-mvl-dove:
upstream_linux-mvl-dove: released (3.2)
hardy_linux-mvl-dove: DNE
lucid_linux-mvl-dove: not-affected (no KVM on ARM)
maverick_linux-mvl-dove: not-affected (no KVM on ARM)
natty_linux-mvl-dove: DNE
oneiric_linux-mvl-dove: DNE
devel_linux-mvl-dove: DNE

Patches_linux-ti-omap4:
upstream_linux-ti-omap4: released (3.2)
hardy_linux-ti-omap4: DNE
lucid_linux-ti-omap4: DNE
maverick_linux-ti-omap4: not-affected (no KVM on ARM)
natty_linux-ti-omap4: not-affected (no KVM on ARM)
oneiric_linux-ti-omap4: not-affected (no KVM on ARM)
devel_linux-ti-omap4: not-affected (no KVM on ARM)

Patches_linux-lts-backport-maverick:
upstream_linux-lts-backport-maverick: released (3.2)
hardy_linux-lts-backport-maverick: DNE
lucid_linux-lts-backport-maverick: pending
maverick_linux-lts-backport-maverick: DNE
natty_linux-lts-backport-maverick: DNE
oneiric_linux-lts-backport-maverick: DNE
devel_linux-lts-backport-maverick: DNE

Patches_linux-fsl-imx51:
upstream_linux-fsl-imx51: released (3.2)
hardy_linux-fsl-imx51: DNE
lucid_linux-fsl-imx51: not-affected (no KVM on ARM)
maverick_linux-fsl-imx51: DNE
natty_linux-fsl-imx51: DNE
oneiric_linux-fsl-imx51: DNE
devel_linux-fsl-imx51: DNE

Patches_linux-lts-backport-natty:
upstream_linux-lts-backport-natty: released (3.2)
hardy_linux-lts-backport-natty: DNE
lucid_linux-lts-backport-natty: pending
maverick_linux-lts-backport-natty: DNE
natty_linux-lts-backport-natty: DNE
oneiric_linux-lts-backport-natty: DNE
devel_linux-lts-backport-natty: DNE

Patches_linux-lts-backport-oneiric:
upstream_linux-lts-backport-oneiric: released (3.2)
hardy_linux-lts-backport-oneiric: DNE
lucid_linux-lts-backport-oneiric: pending (3.0.0-17.30~lucid1)
maverick_linux-lts-backport-oneiric: DNE
natty_linux-lts-backport-oneiric: DNE
oneiric_linux-lts-backport-oneiric: DNE
devel_linux-lts-backport-oneiric: DNE
