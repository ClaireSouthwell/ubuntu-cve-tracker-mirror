Candidate: CVE-2007-3996
References: 
 http://www.secweb.se/en/advisories/php-imagecreatetruecolor-integer-overflow/
 http://www.ubuntu.com/usn/usn-557-1
Description:
 Multiple integer overflows in libgd in PHP before 5.2.4 allow remote
 attackers to cause a denial of service (application crash) and possibly
 execute arbitrary code via a large (1) srcW or (2) srcH value to the (a)
 gdImageCopyResized function, or a large (3) sy (height) or (4) sx (width)
 value to the (b) gdImageCreate or the (c) gdImageCreateTrueColor function.
Ubuntu-Description: 
Notes: 
 jdstrand> note this is gdImageCreate and gdImageCreateTrueColor
 jdstrand> dapper-gutsy libgd2 are affected to varying degrees
 jdstrand> php5-gd segfaults on feisty and gutsy before patching libgd2,
   and dapper-gutsy segfault after (this is because feisty-gutsy had a partial
   fix already in libgd2).  php5-gd is not handling the error condition when
   libgd2 fails properly.  Verified that 5.2.4 works with patched libgd2.
Bugs: 
Priority: medium
Assigned-to: jdstrand

upstream_libgd2: 2.0.35
dapper_libgd2: released (2.0.33-2ubuntu5.3)
edgy_libgd2: released (2.0.33-4ubuntu2.2)
feisty_libgd2: released (2.0.34~rc1-2ubuntu1.2)
gutsy_libgd2: released (2.0.34-1ubuntu1.1)
hardy_libgd2: not-affected (2.0.35.dfsg-3ubuntu1)
devel_libgd2: not-affected (2.0.35.dfsg-3ubuntu1)

upstream_php5: 5.2.4
Patches_php5:
 vendor: http://www.mandriva.com/security/advisories?name=MDKSA-2007:187
dapper_php5: needed
edgy_php5: needed
feisty_php5: needed
gutsy_php5: needed
hardy_php5: not-affected (5.2.4-2ubuntu3)
devel_php5: not-affected (5.2.4-2ubuntu3)
