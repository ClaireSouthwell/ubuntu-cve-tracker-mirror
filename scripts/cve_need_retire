#!/bin/bash

# Author: Jamie Strandboge <jamie@ubuntu.com>
# Author: Kees Cook <kees@ubuntu.com>
# Copyright (C) 2005-2008 Canonical Ltd.
#
# This script is distributed under the terms and conditions of the GNU General
# Public License, Version 2 or later. See http://www.gnu.org/copyleft/gpl.html
# for details.

set -e

#
# Usage:
# ./scripts/cve_need_retire [-p]
#

cvedir="./active"

if [ "$1" = "-h" ]; then
        echo "./scripts/cve_need_retire [-f] [-p]"
        echo "  -f\tfull listing"
	echo "  -p\tlist path to CVE"
        exit 0
fi

full=
if [ "$1" = "-f" ]; then
        shift || true
        full="yes"
fi

path=
if [ "$1" = "-p" ]; then
        shift || true
        path="$cvedir/"
fi

./scripts/ubuntu-table 2>&1 >/dev/null | grep '^retire: ' | while read junk cve
do
	if [ -z "$full" ]; then
		echo "$path$cve"
	else
		cat "$cvedir/$cve"
		echo "--"
	fi
done

