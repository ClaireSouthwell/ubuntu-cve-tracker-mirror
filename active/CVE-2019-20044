Candidate: CVE-2019-20044
PublicDate: 2019-12-31 00:00:00 UTC
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20044
 https://www.zsh.org/mla/zsh-announce/141
Description:
 When unsetting the PRIVILEGED option, the shell sets its effective user
 and group IDs to match their respective real IDs. On some platforms
 (including Linux and macOS, but not FreeBSD), when the RUID and EUID were
 both non-zero, it was possible to regain the shell's former privileges by
 e.g. assigning to the EUID or EGID parameter. In the course of
 investigating this issue, it was also found that the setopt built-in did
 not correctly report errors when unsetting the option, which prevented
 users from handling them as the documentation recommended. setopt now
 returns non-zero if it is unable to safely drop privileges.
Ubuntu-Description:
Notes:
 mdeslaur> reproducer in debian bug
 mdeslaur> low priority since upstream considers this to be a
 mdeslaur> "minor vulnerability"
Mitigation:
Bugs:
 http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=951458
Priority: low
Discovered-by: Sam Foxman
Assigned-to:


Patches_zsh:
 upstream: https://sourceforge.net/p/zsh/code/ci/24e993db62cf146fb76ebcf677a4a7aa3766fc74/
 upstream: https://sourceforge.net/p/zsh/code/ci/8250c5c168f07549ed646e6848e6dda118271e23/
 upstream: https://sourceforge.net/p/zsh/code/ci/26d02efa7a9b0a6b32e1a8bbc6aca6c544b94211/
 upstream: https://sourceforge.net/p/zsh/code/ci/4ce66857b71b40a0661df3780ff557f2b0f4cb13/
 upstream: https://sourceforge.net/p/zsh/code/ci/b15bd4aa590db8087d1e8f2eb1af2874f5db814d/
 upstream: https://sourceforge.net/p/zsh/code/ci/048f40b68b05fdd5f3f8d60cda4e69fce2611331/
 upstream: https://sourceforge.net/p/zsh/code/ci/4bec892059cf3e95ab256c3fcbc85daaa648c2d9/
upstream_zsh: released (5.8-1)
precise/esm_zsh: DNE
trusty_zsh: ignored (out of standard support)
trusty/esm_zsh: DNE
xenial_zsh: needs-triage
bionic_zsh: needed
eoan_zsh: needed
devel_zsh: needed
