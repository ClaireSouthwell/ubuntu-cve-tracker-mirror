#!/usr/bin/env python
# Copyright 2008, Canonical, Ltd
# Author: Kees Cook <kees@ubuntu.com>
# License: GPLv3
#
# This will update any "TODO" items in the secure-testing Debian CVE list
# from the Ubuntu not-for-us list.
from cve_lib import *
import sys

config = read_config()
if len(sys.argv) == 2:
    debian_cve_list = sys.argv[1]
else:
    debian_cve_list = os.path.join(config['secure_testing_path'], "data/CVE/list")

debian = load_debian_cves(debian_cve_list)
reasons = load_ignored_reasons('ignored/not-for-us.txt')

for cve in sorted(reasons.keys()):
    if not debian.has_key(cve):
        # FIXME: load desc (it's ignored, so no desc to load...)
        desc = ''
        prepend_debian_cve(debian_cve_list, cve, desc)

update_debian_ignored_cves(reasons, debian_cve_list)
