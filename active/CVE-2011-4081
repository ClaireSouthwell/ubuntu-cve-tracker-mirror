PublicDateAtUSN: 2011-10-29
Candidate: CVE-2011-4081
PublicDate: 2011-10-29
References:
 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4081
 http://www.ubuntu.com/usn/usn-1286-1
 http://www.ubuntu.com/usn/usn-1287-1
 http://www.ubuntu.com/usn/usn-1292-1
 http://www.ubuntu.com/usn/usn-1293-1
 http://www.ubuntu.com/usn/usn-1294-1
 http://www.ubuntu.com/usn/usn-1302-1
 http://www.ubuntu.com/usn/usn-1301-1
 http://www.ubuntu.com/usn/usn-1303-1
 http://www.ubuntu.com/usn/usn-1299-1
 http://www.ubuntu.com/usn/usn-1304-1
Description:
 Description from the commit: The ghash_update function passes a pointer
 to gf128mul_4k_lle which will be NULL if ghash_setkey is not called or
 if the most recent call to ghash_setkey failed to allocate memory.  This
 causes an oops.  Fix this up by returning an error code in the null case.
 This is trivially triggered from unprivileged userspace through the
 AF_ALG interface by simply writing to the socket without setting a key.
 The ghash_final function has a similar issue, but triggering it requires
 a memory allocation failure in ghash_setkey _after_ at least one
 successful call to ghash_update.
Ubuntu-Description:
 Nick Bowler discovered the kernel GHASH message digest algorithm
 incorrectly handled error conditions. A local attacker could exploit this
 to cause a kernel oops.
Notes:
Bugs:
 https://bugzilla.redhat.com/749475
 https://bugs.gentoo.org/388581
 https://launchpad.net/bugs/887299
Priority: low
Discovered-by: Nick Bowler
Assigned-to: mdeslaur

Patches_linux:
 break-fix: 2cdc6899a88e2b9c6cb82ebd547bf58932d534df 7ed47b7d142ec99ad6880bbbec51e9f12b3af74c
upstream_linux: released (3.1)
hardy_linux: not-affected
lucid_linux: released (2.6.32-37.80)
maverick_linux: released (2.6.35-31.63)
natty_linux: pending (2.6.38-13.53)
oneiric_linux: pending (3.0.0-14.23)
devel_linux: not-affected (3.1.0-2.2)

Patches_linux-ec2:
upstream_linux-ec2: released (3.1)
hardy_linux-ec2: DNE
lucid_linux-ec2: released (2.6.32-341.41)
maverick_linux-ec2: ignored (binary supplied by "linux" now)
natty_linux-ec2: DNE
oneiric_linux-ec2: DNE
devel_linux-ec2: DNE

Patches_linux-mvl-dove:
upstream_linux-mvl-dove: released (3.1)
hardy_linux-mvl-dove: DNE
lucid_linux-mvl-dove: pending (2.6.32-221.39)
maverick_linux-mvl-dove: released (2.6.32-421.39)
natty_linux-mvl-dove: DNE
oneiric_linux-mvl-dove: DNE
devel_linux-mvl-dove: DNE

Patches_linux-ti-omap4:
upstream_linux-ti-omap4: released (3.1)
hardy_linux-ti-omap4: DNE
lucid_linux-ti-omap4: DNE
maverick_linux-ti-omap4: released (2.6.35-903.28)
natty_linux-ti-omap4: released (2.6.38-1209.18)
oneiric_linux-ti-omap4: released (3.0.0-1206.13)
devel_linux-ti-omap4: not-affected

Patches_linux-lts-backport-maverick:
upstream_linux-lts-backport-maverick: released (3.1)
hardy_linux-lts-backport-maverick: DNE
lucid_linux-lts-backport-maverick: released (2.6.35-31.63~lucid1)
maverick_linux-lts-backport-maverick: DNE
natty_linux-lts-backport-maverick: DNE
oneiric_linux-lts-backport-maverick: DNE
devel_linux-lts-backport-maverick: DNE

Patches_linux-fsl-imx51:
upstream_linux-fsl-imx51: released (3.1)
hardy_linux-fsl-imx51: DNE
lucid_linux-fsl-imx51: not-affected
maverick_linux-fsl-imx51: DNE
natty_linux-fsl-imx51: DNE
oneiric_linux-fsl-imx51: DNE
devel_linux-fsl-imx51: DNE

Patches_linux-lts-backport-natty:
upstream_linux-lts-backport-natty: released (3.1)
hardy_linux-lts-backport-natty: DNE
lucid_linux-lts-backport-natty: released (2.6.38-13.53~lucid1)
maverick_linux-lts-backport-natty: DNE
natty_linux-lts-backport-natty: DNE
oneiric_linux-lts-backport-natty: DNE
devel_linux-lts-backport-natty: DNE

Patches_linux-lts-backport-oneiric:
upstream_linux-lts-backport-oneiric: released (3.1)
hardy_linux-lts-backport-oneiric: DNE
lucid_linux-lts-backport-oneiric: released (3.0.0-14.23~lucid1)
maverick_linux-lts-backport-oneiric: DNE
natty_linux-lts-backport-oneiric: DNE
oneiric_linux-lts-backport-oneiric: DNE
devel_linux-lts-backport-oneiric: DNE
