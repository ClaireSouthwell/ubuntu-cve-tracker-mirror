Candidate: CVE-2017-7692
PublicDate: 2017-04-20
References:
 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7692
 http://www.openwall.com/lists/oss-security/2017/04/19/6
Description:
 SquirrelMail 1.4.22 allows post-authentication remote code execution via a
 sendmail.cf file that is mishandled in a popen call. It's possible to
 exploit this vulnerability to execute arbitrary shell commands on the
 remote server. The problem is in the Deliver_SendMail.class.php with the
 initStream function that uses escapeshellcmd() to sanitize the sendmail
 command before executing it. The use of escapeshellcmd() is not correct in
 this case since it doesn't escape whitespaces, allowing the injection of
 arbitrary command parameters. The problem is in -f$envelopefrom within the
 sendmail command line. Hence, if the target server uses sendmail and
 SquirrelMail is configured to use it as a command-line program, it's
 possible to trick sendmail into using an attacker-provided configuration
 file that triggers the execution of an arbitrary command. For exploitation,
 the attacker must upload a sendmail.cf file as an email attachment, and
 inject the sendmail.cf filename with the -C option within the "Options >
 Personal Informations > Email Address" setting.
Ubuntu-Description:
Notes:
 ratliff> Duplicate of CVE-2017-5181
Bugs:
Priority: medium
Discovered-by: Dawid Golunski and Filippo Cavallarin
Assigned-to:

Patches_squirrelmail:
upstream_squirrelmail: needs-triage
precise_squirrelmail: needed
trusty_squirrelmail: needed
vivid/stable-phone-overlay_squirrelmail: DNE
vivid/ubuntu-core_squirrelmail: DNE
xenial_squirrelmail: needed
yakkety_squirrelmail: needed
zesty_squirrelmail: DNE
devel_squirrelmail: DNE
